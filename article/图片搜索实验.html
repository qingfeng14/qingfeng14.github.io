<!-- build time:Wed Jan 08 2020 01:23:16 GMT+0800 (中国标准时间) --><!doctype html><html class="theme-next pisces use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="NulX213KadbLZpcPLeskKULRWdztIKtoHsRG8-LgfWE"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css"><meta name="keywords" content="搜索引擎,Lucene,MyEclipse,BM25,"><link rel="alternate" href="/atom.xml" title="我的日志" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/uploads/favicon.png?v=5.1.0"><meta name="description" content="基本任务查找资料，跑通流程【部署方法】使用MyEclipse导入该工程，运行ImageIndexer建立索引生成forIndex文件夹将forIndex文件夹拷贝到Tomcat的安装目录下（取决于具体运行环境，有的可能需要拷贝到Tomcat_ROOT&#x2F;bin&#x2F;目录下） 此外，由于我在ImageIndexer.java中修改了图片存放位置，因此一定要重新运行ImageIndexer.java生成fo"><meta property="og:type" content="article"><meta property="og:title" content="图片搜索实验"><meta property="og:url" content="https://2young.2simple.top/article/%E5%9B%BE%E7%89%87%E6%90%9C%E7%B4%A2%E5%AE%9E%E9%AA%8C.html"><meta property="og:site_name" content="我的日志"><meta property="og:description" content="基本任务查找资料，跑通流程【部署方法】使用MyEclipse导入该工程，运行ImageIndexer建立索引生成forIndex文件夹将forIndex文件夹拷贝到Tomcat的安装目录下（取决于具体运行环境，有的可能需要拷贝到Tomcat_ROOT&#x2F;bin&#x2F;目录下） 此外，由于我在ImageIndexer.java中修改了图片存放位置，因此一定要重新运行ImageIndexer.java生成fo"><meta property="og:image" content="https://d2ppvlu71ri8gs.cloudfront.net/items/432O083r3y473z0b2a0V/Image%202017-04-29%20at%202.27.09%20%E4%B8%8A%E5%8D%88.png"><meta property="og:image" content="https://d2ppvlu71ri8gs.cloudfront.net/items/3J46260C1Z3b2F19072L/Image%202017-04-29%20at%201.19.26%20%E4%B8%8A%E5%8D%88.png"><meta property="og:image" content="https://d2ppvlu71ri8gs.cloudfront.net/items/1m0P3Y3I3R2N0V461C3V/Image%202017-04-29%20at%201.43.23%20%E4%B8%8A%E5%8D%88.png"><meta property="og:image" content="https://d2ppvlu71ri8gs.cloudfront.net/items/2g3j2D1r0Y1O1b043q08/Image%202017-04-29%20at%201.37.56%20%E4%B8%8A%E5%8D%88.png"><meta property="og:image" content="https://d2ppvlu71ri8gs.cloudfront.net/items/2g1O3u2B0a2n2d3c1T2h/Image%202017-04-29%20at%201.39.53%20%E4%B8%8A%E5%8D%88.png"><meta property="og:image" content="https://d2ppvlu71ri8gs.cloudfront.net/items/2g3j2D1r0Y1O1b043q08/Image%202017-04-29%20at%201.37.56%20%E4%B8%8A%E5%8D%88.png"><meta property="article:published_time" content="2017-04-19T06:57:55.000Z"><meta property="article:modified_time" content="2017-12-29T16:14:10.994Z"><meta property="article:author" content="张盛豪"><meta property="article:tag" content="搜索引擎"><meta property="article:tag" content="Lucene"><meta property="article:tag" content="MyEclipse"><meta property="article:tag" content="BM25"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://d2ppvlu71ri8gs.cloudfront.net/items/432O083r3y473z0b2a0V/Image%202017-04-29%20at%202.27.09%20%E4%B8%8A%E5%8D%88.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Pisces",sidebar:{position:"left",display:"post",offset:12,offset_float:0,b2t:!1,scrollpercent:!1},fancybox:!0,motion:!0,duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"OP8LUUS2MV",apiKey:"7aae391e117d5b22f8d4e63407fc967f",indexName:"indexName",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://2young.2simple.top/article/图片搜索实验.html"><title>图片搜索实验 | 我的日志</title><meta name="generator" content="Hexo 4.2.0"></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-100831019-1","auto"),ga("send","pageview")</script><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?c804d99384f9668e17adfe738b5e74f3";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div style="display:none"><script src="//s5.cnzz.com/z_stat.php?id=1276171070&web_id=1276171070" language="JavaScript"></script></div><div class="container one-collumn sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">我的日志</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">以梦为马，越骑越傻</h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-about"><a href="/about" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>站点地图</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://2young.2simple.top/article/%E5%9B%BE%E7%89%87%E6%90%9C%E7%B4%A2%E5%AE%9E%E9%AA%8C.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="张盛豪"><meta itemprop="description" content=""><meta itemprop="image" content="/uploads/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="我的日志"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">图片搜索实验</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-19T14:57:55+08:00">2017-04-19 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/" itemprop="url" rel="index"><span itemprop="name">搜索引擎</span> </a></span></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a class="cloud-tie-join-count" href="/article/%E5%9B%BE%E7%89%87%E6%90%9C%E7%B4%A2%E5%AE%9E%E9%AA%8C.html#comments" itemprop="discussionUrl"><span class="post-comments-count join-count" itemprop="commentCount"></span> </a></span><span id="/article/%E5%9B%BE%E7%89%87%E6%90%9C%E7%B4%A2%E5%AE%9E%E9%AA%8C.html" class="leancloud_visitors" data-flag-title="图片搜索实验"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数 </span><span class="leancloud-visitors-count"></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">字数统计</span> <span title="字数统计">4.2k </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长</span> <span title="阅读时长">19</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="基本任务"><a href="#基本任务" class="headerlink" title="基本任务"></a>基本任务</h1><h2 id="查找资料，跑通流程"><a href="#查找资料，跑通流程" class="headerlink" title="查找资料，跑通流程"></a>查找资料，跑通流程</h2><h3 id="【部署方法】"><a href="#【部署方法】" class="headerlink" title="【部署方法】"></a>【部署方法】</h3><ul><li>使用MyEclipse导入该工程，运行ImageIndexer建立索引生成forIndex文件夹</li><li>将forIndex文件夹拷贝到Tomcat的安装目录下（取决于具体运行环境，有的可能需要拷贝到<code>Tomcat_ROOT/bin/</code>目录下） 此外，由于我在<code>ImageIndexer.java</code>中修改了图片存放位置，因此一定要重新运行<code>ImageIndexer.java</code>生成forIndex文件并拷贝过去才行（也可直接拷贝提交的forIndex文件）</li><li>将图片解压至<code>/Tomcat_ROOT/webapps/ROOT/pictures/</code>下，</li><li>访问 <code>http://localhost:8080/ImageSearch/imagesearch.jsp</code> 即可进行搜索显示</li></ul><a id="more"></a><h2 id="根据ImageIndexer中对Sogou图片分类目录的索引，对Sogou图片搜索热门查询对应图片建立索引"><a href="#根据ImageIndexer中对Sogou图片分类目录的索引，对Sogou图片搜索热门查询对应图片建立索引" class="headerlink" title="根据ImageIndexer中对Sogou图片分类目录的索引，对Sogou图片搜索热门查询对应图片建立索引"></a>根据ImageIndexer中对Sogou图片分类目录的索引，对Sogou图片搜索热门查询对应图片建立索引</h2><p>首先运行 <code>Encode_gbk_to_utf8.java</code>将gbk编码的threeMonth.xml转换为utf-8编码格式，</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;pic id&#x3D;&quot;278535&quot; query&#x3D;&quot;西藏&quot; total_click&#x3D;&quot;6977&quot; click&#x3D;&quot;14&quot; pic_url&#x3D;&quot;http:&#x2F;&#x2F;travel.bjhotel.cn&#x2F;tour&#x2F;Article&#x2F;UploadFiles&#x2F;200803&#x2F;2008030608595904.jpg&quot; page_url&#x3D;&quot;http:&#x2F;&#x2F;travel.bjhotel.cn&#x2F;tour&#x2F;Article&#x2F;fsyj&#x2F;xz&quot; locate&#x3D;&quot;pictures&#x2F;threeMonth&#x2F;西藏&#x2F;274863.jpg&quot; &#x2F;&gt;</span><br></pre></td></tr></table></figure><p><img src="https://d2ppvlu71ri8gs.cloudfront.net/items/432O083r3y473z0b2a0V/Image%202017-04-29%20at%202.27.09%20%E4%B8%8A%E5%8D%88.png" alt="索引结果"></p><p>threeMonth.xml中对每个搜索词的描述有<code>query，click，total_click，page_url</code>等， 本次索引的field采取query(点击频度暂未找到合适的方法考虑到评分系统内，因此并未考虑该参数)</p><p>由于threeMonth图片集太大，而索引文件中本身有<code>pic_url</code>，因此,我直接采用的是将pic_url作为其picPath,同时将<code>imageshow.jsp</code>中的图片路径改为相对路径，确保图片正确显示（sougou图片集的ImageIndexer.java中需要在路径前加’/‘）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">NamedNodeMap map&#x3D;node.getAttributes();</span><br><span class="line">Node locate&#x3D;map.getNamedItem(&quot;locate&quot;);</span><br><span class="line">Node url &#x3D; map.getNamedItem(&quot;pic_url&quot;);</span><br><span class="line">&#x2F;&#x2F; Node bigClass&#x3D;map.getNamedItem(&quot;bigClass&quot;);</span><br><span class="line">&#x2F;&#x2F; Node smallClass&#x3D;map.getNamedItem(&quot;smallClass&quot;);</span><br><span class="line">Node query&#x3D;map.getNamedItem(&quot;query&quot;);</span><br><span class="line">String absString&#x3D;query.getNodeValue();</span><br><span class="line">Document document  &#x3D;   new  Document();</span><br><span class="line">&#x2F;&#x2F; 采用网页链接作为图片地址</span><br><span class="line">Field PicPathField  &#x3D;   new  Field( &quot;picPath&quot; ,url.getNodeValue(),Field.Store.YES, Field.Index.NO);</span><br><span class="line">Field abstractField  &#x3D;   new  Field( &quot;abstract&quot; ,absString,Field.Store.YES, Field.Index.ANALYZED);</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">process 0</span><br><span class="line">process 10000</span><br><span class="line">process 20000</span><br><span class="line">process 30000</span><br><span class="line">process 40000</span><br><span class="line">process 50000</span><br><span class="line">process 60000</span><br><span class="line">process 70000</span><br><span class="line">process 80000</span><br><span class="line">process 90000</span><br><span class="line">process 100000</span><br><span class="line">process 110000</span><br><span class="line">process 120000</span><br><span class="line">process 130000</span><br><span class="line">process 140000</span><br><span class="line">process 150000</span><br><span class="line">process 160000</span><br><span class="line">process 170000</span><br><span class="line">process 180000</span><br><span class="line">process 190000</span><br><span class="line">process 200000</span><br><span class="line">process 210000</span><br><span class="line">process 220000</span><br><span class="line">process 230000</span><br><span class="line">process 240000</span><br><span class="line">process 250000</span><br><span class="line">process 260000</span><br><span class="line">process 270000</span><br><span class="line">process 280000</span><br><span class="line">process 290000</span><br><span class="line">process 300000</span><br><span class="line">process 310000</span><br><span class="line">process 320000</span><br><span class="line">process 330000</span><br><span class="line">process 340000</span><br><span class="line">average length &#x3D; 4.73518</span><br><span class="line">total 340518 documents</span><br></pre></td></tr></table></figure><h2 id="根据Simple实现的Lucene评分核心类，了解Lucene评分架构，在SimpleScorer-java中实现BM25模型算法（实现很简单）"><a href="#根据Simple实现的Lucene评分核心类，了解Lucene评分架构，在SimpleScorer-java中实现BM25模型算法（实现很简单）" class="headerlink" title="根据Simple实现的Lucene评分核心类，了解Lucene评分架构，在SimpleScorer.java中实现BM25模型算法（实现很简单）"></a>根据Simple实现的Lucene评分核心类，了解Lucene评分架构，在SimpleScorer.java中实现BM25模型算法（实现很简单）</h2><p>给定一个查询 Q,包含了关键词 $q_1, …, q_n$, 利用<a href="https://en.wikipedia.org/wiki/Okapi_BM25" target="_blank" rel="noopener">BM25算法</a>计算出的文档D的得分为:</p><p>$${\text{score}}(D,Q)=\sum <em>{i=1}^{n}{\text{IDF}}(q</em>{i})\cdot {\frac {f(q_{i},D)\cdot (k_{1}+1)}{f(q_{i},D)+k_{1}\cdot \left(1-b+b\cdot {\frac {|D|}{\text{avgdl}}}\right)}}$$</p><p>其中：</p><ul><li>$f(q_i, D)$ 表示关键词$q_i$在文档D中的频率</li><li>|D| 是文档D的长度</li><li>avgdl 是平均文档长度</li><li>$k_1$ 和 b 是调节因子, 通常$k_1 \in [1.2,2.0]$ , b = 0.75 （本实验中$k_i = 2.0$）</li><li>$IDF(q_i)$ 是查询词$q_i$的IDF (inverse document frequency) 权重，是根据每个关键词在所有文档中出现的次数多少对该关键词的一个调整,其计算方式为：$$\text{IDF}(q_i) = \log \frac{N - n(q_i) + 0.5}{n(q_i) + 0.5}$$ 其中N代表文档总数，$n(q_i)$是包含该关键词的文档个数</li></ul><p>查阅Lucene可知，norm的计算为<code>lengthNorm = 1.0 / Math.sqrt(numTerms)</code></p><p>具体实现为：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 文档termDocs中关键词qi的频率</span></span><br><span class="line"><span class="keyword">float</span> f_qi_D = <span class="keyword">this</span>.termDocs.freq();</span><br><span class="line"><span class="comment">// doc对应的文档长度计算， norms[i] = 1/sqrt(length[i])</span></span><br><span class="line"><span class="keyword">float</span> norm = Similarity.decodeNorm(<span class="keyword">this</span>.norms[doc]);</span><br><span class="line"><span class="comment">// 文档termDocs的长度</span></span><br><span class="line"><span class="keyword">float</span> length = <span class="number">1</span> / (norm * norm);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BM25算法</span></span><br><span class="line"><span class="keyword">return</span> idf * f_qi_D * (<span class="keyword">this</span>.K1 + <span class="number">1</span>)/ (f_qi_D + <span class="keyword">this</span>.K1 *(<span class="number">1</span> - <span class="keyword">this</span>.b + <span class="keyword">this</span>.b * length/<span class="keyword">this</span>.avgLength));</span><br></pre></td></tr></table></figure><h2 id="利用Lucene提供的评分核心类实现VSM模型，并与BM25进行对比"><a href="#利用Lucene提供的评分核心类实现VSM模型，并与BM25进行对比" class="headerlink" title="利用Lucene提供的评分核心类实现VSM模型，并与BM25进行对比"></a>利用Lucene提供的评分核心类实现VSM模型，并与BM25进行对比</h2><p>原始评分算法即为VSM。</p><p>BM25和VSM算法的搜索结果没有明显差异，score值是明显不同的（这里的score值是开启了多关键词查询之后的结果）</p><h3 id="BM25算法"><a href="#BM25算法" class="headerlink" title="BM25算法"></a>BM25算法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;下面是普通merge的结果&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">doc&#x3D;15007 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;0.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15008 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;10.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15009 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;11.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15010 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;12.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15011 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;13.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15012 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;14.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15013 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;15.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15014 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;16.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15015 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;17.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15016 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;18.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br></pre></td></tr></table></figure><h3 id="VSM算法"><a href="#VSM算法" class="headerlink" title="VSM算法"></a>VSM算法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;下面是普通merge的结果&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">doc&#x3D;15007 score&#x3D;5.85986 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;0.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15008 score&#x3D;5.85986 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;10.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15009 score&#x3D;5.85986 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;11.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15010 score&#x3D;5.85986 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;12.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15011 score&#x3D;5.85986 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;13.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15012 score&#x3D;5.85986 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;14.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15013 score&#x3D;5.85986 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;15.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15014 score&#x3D;5.85986 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;16.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15015 score&#x3D;5.85986 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;17.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15016 score&#x3D;5.85986 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;18.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br></pre></td></tr></table></figure><h1 id="扩展任务"><a href="#扩展任务" class="headerlink" title="扩展任务"></a>扩展任务</h1><h2 id="基于语料库所提供的图片所在网页内容，对图片描述文本进行扩充，实现基于图片描述文本的图像检索"><a href="#基于语料库所提供的图片所在网页内容，对图片描述文本进行扩充，实现基于图片描述文本的图像检索" class="headerlink" title="基于语料库所提供的图片所在网页内容，对图片描述文本进行扩充，实现基于图片描述文本的图像检索"></a>基于语料库所提供的图片所在网页内容，对图片描述文本进行扩充，实现基于图片描述文本的图像检索</h2><h2 id="基于BM25模型实现对于查询词的分词检索（参考Lucene的MultiTermQuery对应的核心评分类实现，也可参考网上的开源代码，最终大作业时需要）"><a href="#基于BM25模型实现对于查询词的分词检索（参考Lucene的MultiTermQuery对应的核心评分类实现，也可参考网上的开源代码，最终大作业时需要）" class="headerlink" title="基于BM25模型实现对于查询词的分词检索（参考Lucene的MultiTermQuery对应的核心评分类实现，也可参考网上的开源代码，最终大作业时需要）"></a>基于BM25模型实现对于查询词的分词检索（参考Lucene的MultiTermQuery对应的核心评分类实现，也可参考网上的开源代码，最终大作业时需要）</h2><p>分词工具采用IKAnalyzer, 具体实现参考了<a href="http://blog.sina.com.cn/s/blog_7663527601012vdg.html" target="_blank" rel="noopener">IKAnalyzer中文分词器 </a>[<a href="http://blog.sina.com.cn/s/blog_7663527601012vdg.html]一文。" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_7663527601012vdg.html]一文。</a></p><p>一开始的实现是直接将查询词使用IKAnalyzer进行分词，然后将每个关键词分别作为搜索词去查询，然后将查询结果merge起来，按照得分高低排序。如下所示：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//基于Lucene实现</span></span><br><span class="line">Analyzer analyzer = <span class="keyword">new</span> IKAnalyzer(<span class="keyword">true</span>);<span class="comment">//true智能切分</span></span><br><span class="line">StringReader reader = <span class="keyword">new</span> StringReader(queryString);</span><br><span class="line">TokenStream ts = analyzer.tokenStream(<span class="string">""</span>, reader);</span><br><span class="line">CharTermAttribute term = ts.getAttribute(CharTermAttribute<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">List&lt;String&gt; key_word = <span class="keyword">new</span> ArrayList&lt;String&gt;();  </span><br><span class="line"><span class="keyword">while</span>(ts.incrementToken())&#123;</span><br><span class="line">    <span class="comment">// System.out.print(term.toString()+"|");</span></span><br><span class="line">    key_word.add(term.toString());</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(key_word);</span><br><span class="line"></span><br><span class="line">TopDocs[] resultsArray = <span class="keyword">new</span> TopDocs[key_word.size()];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; key_word.size(); ++j) &#123;</span><br><span class="line">    <span class="comment">// 针对每个搜索词去查询</span></span><br><span class="line">    resultsArray[j] = search.searchQuery(key_word.get(j), <span class="string">"abstract"</span>, <span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TopDocs results=search.searchQuery(queryString, "abstract", 100);</span></span><br><span class="line">TopDocs results = TopDocs.merge(<span class="keyword">null</span>, <span class="number">100</span>, resultsArray);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">"=========下面是普通merge的结果=========="</span>);</span><br><span class="line"><span class="keyword">if</span> (results != <span class="keyword">null</span>) &#123;</span><br><span class="line">    ScoreDoc[] hits = showList(results.scoreDocs, page);</span><br><span class="line">    <span class="keyword">if</span> (hits != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// tags = new String[hits.length];</span></span><br><span class="line">        <span class="comment">// paths = new String[hits.length];</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; hits.length &amp;&amp; i &lt; PAGE_RESULT; i++) &#123;</span><br><span class="line">            Document doc = search.getDoc(hits[i].doc);</span><br><span class="line">            System.out.println(<span class="string">"doc="</span> + hits[i].doc + <span class="string">" score="</span></span><br><span class="line">                    + hits[i].score + <span class="string">" picPath= "</span></span><br><span class="line">                    + doc.get(<span class="string">"picPath"</span>)+ <span class="string">" tag= "</span>+doc.get(<span class="string">"abstract"</span>));</span><br><span class="line">            <span class="comment">// tags[i] = doc.get("abstract");</span></span><br><span class="line">            <span class="comment">// paths[i] = picDir + doc.get("picPath");</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"page null"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"result null"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但是在实际操作中发现，这样的查询操作是由问题的，表现极差，无法达到搜索者预期的多次查询需求，于是通过进一步的搜索和查询相关资料，最后决定采用 MultiFieldQueryParser的方式进行多关键词查询。实现参考<a href="http://www.jianshu.com/p/055ddb99819d" target="_blank" rel="noopener">博客- 关键词高亮（lucene笔记)</a> <a href="http://www.jianshu.com/p/055ddb99819d" target="_blank" rel="noopener">http://www.jianshu.com/p/055ddb99819d</a></p><p>该函数可以实现多个关键词在不同的field中进行查询的功能，同时可以设定多个关键词之间的关系：<code>and, not, or</code>, 这里我们采用或的逻辑关系，同时设置field为‘abstract’，具体实现如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//待查找字符串对应的字段</span></span><br><span class="line">String [] to_query = &#123;queryString&#125;;</span><br><span class="line">String [] fields = &#123;<span class="string">"abstract"</span>&#125;;</span><br><span class="line"><span class="comment">//Occur.MUST表示对应字段必须有查询值， Occur.MUST_NOT 表示对应字段必须没有查询值， Occur.SHOULD(结果“或”)</span></span><br><span class="line">Occur[] occ=&#123;Occur.SHOULD&#125;;</span><br><span class="line">Query query = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    query = MultiFieldQueryParser.parse(Version.LUCENE_35, to_query,fields,occ,analyzer);</span><br><span class="line">    System.out.println(query);</span><br><span class="line">&#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">    <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">results = search.searchQuery(query, <span class="string">"abstract"</span>, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">"============\n=========下面是MultiFieldQueryParser的结果=========="</span>);</span><br><span class="line"><span class="keyword">if</span> (results != <span class="keyword">null</span>) &#123;</span><br><span class="line">    ScoreDoc[] hits = showList(results.scoreDocs, page);</span><br><span class="line">    <span class="keyword">if</span> (hits != <span class="keyword">null</span>) &#123;</span><br><span class="line">        tags = <span class="keyword">new</span> String[hits.length];</span><br><span class="line">        paths = <span class="keyword">new</span> String[hits.length];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; hits.length &amp;&amp; i &lt; PAGE_RESULT; i++) &#123;</span><br><span class="line">            Document doc = search.getDoc(hits[i].doc);</span><br><span class="line">            System.out.println(<span class="string">"doc="</span> + hits[i].doc + <span class="string">" score="</span></span><br><span class="line">                    + hits[i].score + <span class="string">" picPath= "</span></span><br><span class="line">                    + doc.get(<span class="string">"picPath"</span>)+ <span class="string">" tag= "</span>+doc.get(<span class="string">"abstract"</span>));</span><br><span class="line">            tags[i] = doc.get(<span class="string">"abstract"</span>);</span><br><span class="line">            paths[i] = picDir + doc.get(<span class="string">"picPath"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"page null"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"result null"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>实现结果对比：</p><p>搜索关键词为 <code>港台女星</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[港台, 女星]</span><br><span class="line">org.apache.lucene.search.TopDocs@23506dfb</span><br><span class="line">org.apache.lucene.search.TopDocs@75648bd9</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;下面是普通merge的结果&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">doc&#x3D;15007 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;0.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15008 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;10.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15009 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;11.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15010 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;12.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15011 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;13.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15012 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;14.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15013 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;15.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15014 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;16.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15015 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;17.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15016 score&#x3D;8.551983 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;18.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">(abstract:港台 abstract:女星)</span><br><span class="line">org.apache.lucene.search.TopDocs@292b2c95</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;下面是MultiFieldQueryParser的结果&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">doc&#x3D;42133 score&#x3D;20.643898 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;阿雅&#x2F;0.jpg tag&#x3D; 性感女星 港台女星 阿雅</span><br><span class="line">doc&#x3D;42134 score&#x3D;20.643898 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;阿雅&#x2F;10.jpg tag&#x3D; 性感女星 港台女星 阿雅</span><br><span class="line">doc&#x3D;42135 score&#x3D;20.643898 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;阿雅&#x2F;11.jpg tag&#x3D; 性感女星 港台女星 阿雅</span><br><span class="line">doc&#x3D;42136 score&#x3D;20.643898 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;阿雅&#x2F;12.jpg tag&#x3D; 性感女星 港台女星 阿雅</span><br><span class="line">doc&#x3D;42137 score&#x3D;20.643898 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;阿雅&#x2F;13.jpg tag&#x3D; 性感女星 港台女星 阿雅</span><br><span class="line">doc&#x3D;42138 score&#x3D;20.643898 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;阿雅&#x2F;14.jpg tag&#x3D; 性感女星 港台女星 阿雅</span><br><span class="line">doc&#x3D;42139 score&#x3D;20.643898 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;阿雅&#x2F;15.jpg tag&#x3D; 性感女星 港台女星 阿雅</span><br><span class="line">doc&#x3D;42140 score&#x3D;20.643898 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;阿雅&#x2F;16.jpg tag&#x3D; 性感女星 港台女星 阿雅</span><br><span class="line">doc&#x3D;42141 score&#x3D;20.643898 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;阿雅&#x2F;17.jpg tag&#x3D; 性感女星 港台女星 阿雅</span><br><span class="line">doc&#x3D;42142 score&#x3D;20.643898 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;阿雅&#x2F;18.jpg tag&#x3D; 性感女星 港台女星 阿雅</span><br></pre></td></tr></table></figure><p>MultiFieldQueryParser查询方式的搜索结果如下：</p><p>多关键词查询的靠前结果同时满足两个关键词</p><p><img src="https://d2ppvlu71ri8gs.cloudfront.net/items/3J46260C1Z3b2F19072L/Image%202017-04-29%20at%201.19.26%20%E4%B8%8A%E5%8D%88.png" alt="港台 女星  第一页"></p><p>从第6页开始出现了港台美女等相关搜索结果，能够实现关键词或的查询</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;下面是MultiFieldQueryParser的结果&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">doc&#x3D;42163 score&#x3D;17.694769 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;安雅&#x2F;2.jpg tag&#x3D; 性感女星 港台女星 安雅</span><br><span class="line">doc&#x3D;42164 score&#x3D;17.694769 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;安雅&#x2F;3.jpg tag&#x3D; 性感女星 港台女星 安雅</span><br><span class="line">doc&#x3D;42165 score&#x3D;17.694769 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;安雅&#x2F;4.jpg tag&#x3D; 性感女星 港台女星 安雅</span><br><span class="line">doc&#x3D;42166 score&#x3D;17.694769 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;安雅&#x2F;5.jpg tag&#x3D; 性感女星 港台女星 安雅</span><br><span class="line">doc&#x3D;42167 score&#x3D;17.694769 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;安雅&#x2F;6.jpg tag&#x3D; 性感女星 港台女星 安雅</span><br><span class="line">doc&#x3D;42168 score&#x3D;17.694769 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;安雅&#x2F;7.jpg tag&#x3D; 性感女星 港台女星 安雅</span><br><span class="line">doc&#x3D;42169 score&#x3D;17.694769 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;安雅&#x2F;8.jpg tag&#x3D; 性感女星 港台女星 安雅</span><br><span class="line">doc&#x3D;42170 score&#x3D;17.694769 picPath&#x3D; pictures&#x2F;sogou&#x2F;性感女星&#x2F;港台女星&#x2F;安雅&#x2F;9.jpg tag&#x3D; 性感女星 港台女星 安雅</span><br><span class="line">doc&#x3D;15007 score&#x3D;15.022858 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;0.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br><span class="line">doc&#x3D;15008 score&#x3D;15.022858 picPath&#x3D; pictures&#x2F;sogou&#x2F;精美壁纸&#x2F;人物壁纸&#x2F;港台美女&#x2F;10.jpg tag&#x3D; 精美壁纸 人物壁纸 港台美女</span><br></pre></td></tr></table></figure><p><img src="https://d2ppvlu71ri8gs.cloudfront.net/items/1m0P3Y3I3R2N0V461C3V/Image%202017-04-29%20at%201.43.23%20%E4%B8%8A%E5%8D%88.png" alt="港台 女星 第6页"></p><p>由此可以验证该多关键词查询实现是合理有效的。</p><h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>注意：在进行多关键词查询时需要修改ImageIndexer中的analyzer，将其设置为智能分词，不然会出现一些奇怪的查询结果：</p><p><img src="https://d2ppvlu71ri8gs.cloudfront.net/items/2g3j2D1r0Y1O1b043q08/Image%202017-04-29%20at%201.37.56%20%E4%B8%8A%E5%8D%88.png" alt="搜索港台美女时第一页出现的是港台男星"></p><p>将ImageIndexer的analyzer设置为智能分词即 <code>analyzer = new IKAnalyzer(true);</code>之后的搜索结果</p><p><img src="https://d2ppvlu71ri8gs.cloudfront.net/items/2g1O3u2B0a2n2d3c1T2h/Image%202017-04-29%20at%201.39.53%20%E4%B8%8A%E5%8D%88.png" alt="修改后港台美女搜索结果第一页正常"></p><p><img src="https://d2ppvlu71ri8gs.cloudfront.net/items/2g3j2D1r0Y1O1b043q08/Image%202017-04-29%20at%201.37.56%20%E4%B8%8A%E5%8D%88.png" alt="第三页开始出现相关搜索结果 港台男星"></p></div><div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>打赏</div><button id="rewardButton" disable="enable" onclick='var e=document.getElementById("QR");"none"===e.style.display?e.style.display="block":e.style.display="none"'><span>赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="/uploads/wechat-pay.png" alt="张盛豪 WeChat Pay"><p>微信打赏</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" src="/uploads/ali-pay.jpg" alt="张盛豪 Alipay"><p>支付宝打赏</p></div></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong> 张盛豪</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://2young.2simple.top/article/%E5%9B%BE%E7%89%87%E6%90%9C%E7%B4%A2%E5%AE%9E%E9%AA%8C.html" title="图片搜索实验">https://2young.2simple.top/article/%E5%9B%BE%E7%89%87%E6%90%9C%E7%B4%A2%E5%AE%9E%E9%AA%8C.html</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0 CN</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E8%AF%BE%E7%A8%8B/" rel="tag"># 课程</a> <a href="/tags/%E5%AE%9E%E9%AA%8C/" rel="tag"># 实验</a> <a href="/tags/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/" rel="tag"># 搜索引擎</a> <a href="/tags/%E5%9B%BE%E7%89%87%E6%90%9C%E7%B4%A2/" rel="tag"># 图片搜索</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/article/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95.html" rel="next" title="安卓开发记录"><i class="fa fa-chevron-left"></i> 安卓开发记录</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/article/CRC_report.html" rel="prev" title="实验 1 Cache 替换策略设计与分析">实验 1 Cache 替换策略设计与分析 <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/uploads/avatar.jpg" alt="张盛豪"><p class="site-author-name" itemprop="name">张盛豪</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives"><span class="site-state-item-count">50</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">16</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">50</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/qingfeng14" target="_blank" title="GitHub" rel="external nofollow"><i class="fa fa-fw fa-github"></i> GitHub </a></span><span class="links-of-author-item"><a href="https://www.facebook.com/qingfeng.alex" target="_blank" title="Facebook" rel="external nofollow"><i class="fa fa-fw fa-facebook"></i> Facebook </a></span><span class="links-of-author-item"><a href="http://weibo.com/qingfeng14" target="_blank" title="微博" rel="external nofollow"><i class="fa fa-fw fa-weibo"></i> 微博 </a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/alex-zhangch/activities" target="_blank" title="知乎" rel="external nofollow"><i class="fa fa-fw fa-user-o"></i> 知乎 </a></span><span class="links-of-author-item"><a href="http://music.163.com/#/user/home?id=95180074" target="_blank" title="网易云" rel="external nofollow"><i class="fa fa-fw fa-music"></i> 网易云</a></span></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#基本任务"><span class="nav-number">1.</span> <span class="nav-text">基本任务</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#查找资料，跑通流程"><span class="nav-number">1.1.</span> <span class="nav-text">查找资料，跑通流程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#【部署方法】"><span class="nav-number">1.1.1.</span> <span class="nav-text">【部署方法】</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#根据ImageIndexer中对Sogou图片分类目录的索引，对Sogou图片搜索热门查询对应图片建立索引"><span class="nav-number">1.2.</span> <span class="nav-text">根据ImageIndexer中对Sogou图片分类目录的索引，对Sogou图片搜索热门查询对应图片建立索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#根据Simple实现的Lucene评分核心类，了解Lucene评分架构，在SimpleScorer-java中实现BM25模型算法（实现很简单）"><span class="nav-number">1.3.</span> <span class="nav-text">根据Simple实现的Lucene评分核心类，了解Lucene评分架构，在SimpleScorer.java中实现BM25模型算法（实现很简单）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#利用Lucene提供的评分核心类实现VSM模型，并与BM25进行对比"><span class="nav-number">1.4.</span> <span class="nav-text">利用Lucene提供的评分核心类实现VSM模型，并与BM25进行对比</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#BM25算法"><span class="nav-number">1.4.1.</span> <span class="nav-text">BM25算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#VSM算法"><span class="nav-number">1.4.2.</span> <span class="nav-text">VSM算法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#扩展任务"><span class="nav-number">2.</span> <span class="nav-text">扩展任务</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#基于语料库所提供的图片所在网页内容，对图片描述文本进行扩充，实现基于图片描述文本的图像检索"><span class="nav-number">2.1.</span> <span class="nav-text">基于语料库所提供的图片所在网页内容，对图片描述文本进行扩充，实现基于图片描述文本的图像检索</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基于BM25模型实现对于查询词的分词检索（参考Lucene的MultiTermQuery对应的核心评分类实现，也可参考网上的开源代码，最终大作业时需要）"><span class="nav-number">2.2.</span> <span class="nav-text">基于BM25模型实现对于查询词的分词检索（参考Lucene的MultiTermQuery对应的核心评分类实现，也可参考网上的开源代码，最终大作业时需要）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#注意"><span class="nav-number">2.2.1.</span> <span class="nav-text">注意</span></a></li></ol></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2016 - <span itemprop="copyrightYear">2020</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">张盛豪</span></div><div class="powered-by">由 <a class="theme-link" href="https://hexo.io" target="_blank" rel="external nofollow noopener">Hexo</a> 强力驱动</div><div class="powered-by"><a href="http://www.beian.miit.gov.cn/" target="_blank" rel="noopener" style="color:#939393">京ICP备18050719号</a></div><div class="theme-info">主题 - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="external nofollow noopener">NexT.Pisces</a></div><br><div class="powered-by">Contact Me @ <a href="https://www.zhihu.com/people/alex-zhangch/activities" target="_blank" title="知乎" rel="external nofollow">知乎</a></div><div class="powered-by"><a href="https://github.com/qingfeng14" target="_blank" title="GitHUb" rel="external nofollow">GitHub</a></div><div class="powered-by"><a href="http://weibo.com/qingfeng14" target="_blank" title="微博" rel="external nofollow">微博</a></div><div class="theme-info"><a href="mailto:zhangshenghao1995@163.com?subject=用户意见" target="_blank" title="邮箱" rel="external nofollow">邮箱</a></div><div style="width:300px;margin:0 auto;padding:0 0"><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11011102001136" style="display:inline-block;text-decoration:none;height:20px;line-height:20px"><img src="/uploads/beian.png" style="float:left"><p style="float:left;height:20px;line-height:20px;margin:0 0 0 5px;color:#939393">京公网安备 11011102001136号</p></a></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script><script>var cloudTieConfig={url:document.location.href,sourceId:"",productKey:"d5c03ba471cf40c0b5831477b3e52b64",target:"cloud-tie-wrapper"}</script><script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".popup").toggle()}var isfetched=!1,search_path="search.xml";0==search_path.length&&(search_path="search.xml");var path="/"+search_path,searchFunc=function(e,t,a){"use strict";$.ajax({url:e,dataType:"xml",async:!0,success:function(e){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var r=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),c=document.getElementById(t),s=document.getElementById(a);c.addEventListener("input",function(){var e=0,t='<ul class="search-result-list">',a=this.value.trim().toLowerCase().split(/[\s\-]+/);s.innerHTML="",this.value.trim().length>1&&r.forEach(function(r){var c=!1,s=r.title.trim().toLowerCase(),o=r.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),n=decodeURIComponent(r.url),i=-1,l=-1,p=-1;if(""!=s&&a.forEach(function(e,t){i=s.indexOf(e),l=o.indexOf(e),(i>=0||l>=0)&&(c=!0,0==t&&(p=l))}),c){e+=1,t+="<li><a href='"+n+"' class='search-result-title'>"+s+"</a>";var h=r.content.trim().replace(/<[^>]+>/g,"");if(p>=0){var u=p-20,d=p+80;u<0&&(u=0),0==u&&(d=50),d>h.length&&(d=h.length);var f=h.substring(u,d);a.forEach(function(e){var t=new RegExp(e,"gi");f=f.replace(t,'<b class="search-keyword">'+e+"</b>")}),t+='<p class="search-result">'+f+"...</p>"}t+="</li>"}}),t+="</ul>",0==e&&(t='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'),""==a&&(t='<div id="no-result"><i class="fa fa-search fa-5x" /></div>'),s.innerHTML=t}),proceedsearch()}})};$(".popup-trigger").click(function(e){e.stopPropagation(),0==isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(function(e){$(".popup").hide(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")}),$(".popup").click(function(e){e.stopPropagation()})</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });</script><script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("VtTcivvjyRHmU2GlrgFshvUm-gzGzoHsz","Ls6YjvYF6PU5qtBlLt7DpMnr")</script><script>function showTime(e){var t=new AV.Query(e),n=[],o=$(".leancloud_visitors");o.each(function(){n.push($(this).attr("id").trim())}),t.containedIn("url",n),t.find().done(function(e){var t=".leancloud-visitors-count";if(0===e.length)return void o.find(t).text(0);for(var i=0;i<e.length;i++){var r=e[i],s=r.get("url"),l=r.get("time"),c=document.getElementById(s);$(c).find(t).text(l)}for(var i=0;i<n.length;i++){var s=n[i],c=document.getElementById(s),u=$(c).find(t);""==u.text()&&u.text(0)}}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var r=new e,s=new AV.ACL;s.setPublicReadAccess(!0),s.setPublicWriteAccess(!0),r.setACL(s),r.set("title",o),r.set("url",n),r.set("time",1),r.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script></body></html><!-- rebuild by neat -->